// This snippet file was generated by processing the source file:
// snippets/firestore-next/test-solution-counters/increment_counter.js
//
// To make edits to the snippets in this file, please edit the source

// [START modular_increment_counter]
function incrementCounter(db, ref, num_shards) {
    import { collection, doc, updateDoc, increment, FirebaseFirestore } from "@firebase/firestore";

    // Select a shard of the counter at random
    const shardId = Math.floor(Math.random() * num_shards).toString();
    const shardRef = doc(collection(ref, 'shards'), shardId);

    // Update count
    return updateDoc(shardRef, "count", increment(1));
}
// [END modular_increment_counter]