// This snippet file was generated by processing the source file:
// ./auth-next/manage.js
//
// To update the snippets in this file, edit the source and then run
// 'npm run snippets'.

// [START auth_reauth_with_credential_modular]
import { getAuth, reauthenticateWithCredential, EmailAuthProvider} from "firebase/auth";

const auth = getAuth();
const user = auth.currentUser;

// prompt the user to re-provide their sign-in credentials
const promptForCredentials = (userProvidedPassword) => {
  return EmailAuthProvider.credential(user.email, userProvidedPassword);
}

const credential = promptForCredentials(userProvidedPassword);

reauthenticateWithCredential(user, credential).then(() => {
  // User re-authenticated.
}).catch((error) => {
  // An error ocurred
  // ...
});
// [END auth_reauth_with_credential_modular]
